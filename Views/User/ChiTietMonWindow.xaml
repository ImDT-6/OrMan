<Window x:Class="GymManagement.Views.User.ChiTietMonWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Chi Tiết Món" Height="600" Width="500"
        WindowStartupLocation="CenterScreen" WindowStyle="None"
        AllowsTransparency="True" Background="Transparent">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/InputStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Border Background="{StaticResource MainBackgroundGradient}" CornerRadius="25" BorderBrush="{StaticResource GlassBorder}" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="200"/>
                <!-- Ảnh món -->
                <RowDefinition Height="*"/>
                <!-- Tùy chọn -->
                <RowDefinition Height="Auto"/>
                <!-- Nút đặt -->
            </Grid.RowDefinitions>

            <!-- 1. Ảnh Header -->
            <Grid Grid.Row="0">
                <Border CornerRadius="25,25,0,0">
                    <Border.Background>
                        <ImageBrush ImageSource="{Binding HinhAnhUrl}" Stretch="UniformToFill" Opacity="0.8"/>
                    </Border.Background>
                </Border>

                <!-- [ĐÃ SỬA CHUẨN] Nút Đóng (Viết lại Template để căn giữa tuyệt đối) -->
                <!-- Bỏ Style="NavButtonStyle" vì nó gây lệch icon -->
                <Button Click="BtnClose_Click" 
                        HorizontalAlignment="Right" VerticalAlignment="Top" Margin="15"
                        Width="40" Height="40"
                        Background="#50000000"
                        Cursor="Hand">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Grid>
                                <!-- Nền nút (Hình tròn hoặc bo góc) -->
                                <Border x:Name="bdr" Background="{TemplateBinding Background}" CornerRadius="20">
                                    <!-- Nội dung (Icon) canh giữa -->
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <!-- [MỚI] Hiệu ứng khi di chuột: Đổi màu nền sang đỏ cam nhạt -->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="bdr" Property="Background" Value="{StaticResource AccentGradient}"/>
                                    <!-- Bạn có thể chỉnh màu khác, ví dụ "#AAEF4444"(đỏ cam) #80FFFFFF (trắng mờ) hoặc #AA000000 (đen mờ) -->
                                </Trigger>

                                <!-- Hiệu ứng khi nhấn giữ -->
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="bdr" Property="Opacity" Value="0.8"/>
                                    <Setter Property="RenderTransform">
                                        <Setter.Value>
                                            <ScaleTransform ScaleX="0.95" ScaleY="0.95" CenterX="20" CenterY="20"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>

                    <!-- Icon X -->
                    <Path Data="{StaticResource IconClose}" Fill="White" Stretch="Uniform" Width="14" Height="14"/>
                </Button>
                <!-- Tên và Giá -->
                <StackPanel VerticalAlignment="Bottom" Margin="20">
                    <TextBlock Text="{Binding TenMon}" FontSize="24" FontWeight="Bold" Foreground="White">
                        <TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="1"/>
                        </TextBlock.Effect>
                    </TextBlock>
                    <TextBlock Text="{Binding GiaBan, StringFormat='{}{0:N0} đ'}" FontSize="20" Foreground="{StaticResource WarningYellow}" FontWeight="Bold">
                        <TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="1"/>
                        </TextBlock.Effect>
                    </TextBlock>
                </StackPanel>
            </Grid>

            <!-- 2. Tùy Chọn (Scroll được) -->
            <ScrollViewer Grid.Row="1" Padding="20">
                <StackPanel>
                    <!-- CHỌN CẤP ĐỘ CAY (Chỉ hiện nếu là Mì Cay) -->
                    <StackPanel x:Name="PnlCapDoCay">
                        <TextBlock Text="Chọn Cấp Độ Cay" FontSize="16" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>
                        <ItemsControl x:Name="LevelItemsControl">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <RadioButton GroupName="LevelCay" Content="{Binding}" Style="{StaticResource FilterRadioButtonStyle}" Margin="0,0,10,10" MinWidth="60"
                                                 Checked="RadioButton_Checked" Foreground="White"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <Border Height="1" Background="{StaticResource GlassBorder}" Margin="0,20"/>
                    </StackPanel>

                    <!-- Ghi chú -->
                    <TextBlock Text="Ghi chú cho bếp" FontSize="16" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>
                    <TextBox x:Name="txtNote" Style="{StaticResource GlassTextBox}" Height="80" TextWrapping="Wrap" ToolTip="Ví dụ: Không hành, ít nước..." VerticalContentAlignment="Top" Padding="15"/>

                    <!-- Số lượng -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,30,0,0">
                        <Button Content="-" Click="BtnGiam_Click" Style="{StaticResource GlassButtonStyle}" Width="50" Background="#30FFFFFF"/>
                        <TextBlock x:Name="txtSoLuong" Text="1" Foreground="White" FontSize="24" FontWeight="Bold" VerticalAlignment="Center" Margin="20,0"/>
                        <Button Content="+" Click="BtnTang_Click" Style="{StaticResource GlassButtonStyle}" Width="50" Background="#30FFFFFF"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>

            <!-- 3. Nút Xác Nhận -->
            <Border Grid.Row="2" Padding="20" Background="#20000000" CornerRadius="0,0,25,25">
                <Button x:Name="btnConfirm" Content="Thêm vào giỏ - 65,000 đ" Click="BtnConfirm_Click" Style="{StaticResource GlassButtonStyle}" Background="{StaticResource AccentGradient}" Height="50" FontSize="18"/>
            </Border>
        </Grid>
    </Border>
</Window>